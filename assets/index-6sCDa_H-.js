(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const n={pokemonList:[],filteredPokemons:[],allPokemon:[],currentOffset:0,limit:20,selectedFilters:{color:[],gender:"",types:[]},availableFilters:{color:[],gender:[],types:[]},searchTerm:"",totalPokemon:0},m="https://pokeapi.co/api/v2",_=async()=>{const e=`${m}/pokedex/national`,o=await fetch(e);if(!o.ok)return Promise.reject({error:`Something went wrong while retrieving Pokemons at ${e}`});const t=await o.json();return n.allPokemon=t.pokemon_entries,n.totalPokemon=t.pokemon_entries.length,t},f=async({pokemonList:e,offset:o,limit:t})=>{if(!e||o===null||t===null){console.error("You need to provide proper entry data in order to fetch.");return}const s=e.slice(o,o+t);return n.currentOffset=o+t,await Promise.all(s.map(async r=>{const l=await(await fetch(`${m}/pokemon/${r.entry_number}`)).json(),a={name:r.pokemon_species.name,url:`${m}/pokemon/${r.entry_number}`,id:r.entry_number,types:l.types.map(c=>c.type.name)};return n.pokemonList=[...n.pokemonList,a].sort((c,y)=>c.id-y.id),a})).catch(r=>console.error(r))},w=async()=>{const[e,o,t]=await Promise.all([fetch(`${m}/pokemon-color`).then(s=>s.json()),fetch(`${m}/gender`).then(s=>s.json()),fetch(`${m}/type`).then(s=>s.json())]);return n.availableFilters.color=[...e.results],n.availableFilters.gender=[...o.results],n.availableFilters.types=[...t.results],{colors:e.results,genders:o.results,types:t.results}},v=e=>{if(console.log("handleColorClick event",e),e.target.classList.contains("color-box")){const o=`
      <svg style="pointer-events: none" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17.837 17.837" xml:space="preserve"><path style="fill:#fff" d="M16.145 2.571a.7.7 0 0 0-.99 0L6.92 10.804l-4.241-4.27a.698.698 0 0 0-.989 0L.204 8.019a.703.703 0 0 0 0 .99l6.217 6.258a.704.704 0 0 0 .99 0L17.63 5.047a.7.7 0 0 0 0-.994l-1.485-1.482z"/></svg>
    `;e.target.classList.contains("selected")?(e.target.classList.remove("selected"),e.target.innerHTML="",n.selectedFilters.color=n.selectedFilters.color.filter(t=>t!==e.target.dataset.color)):(e.target.classList.add("selected"),e.target.innerHTML=o,n.selectedFilters.color=Array.from(new Set([...n.selectedFilters.color,e.target.dataset.color])))}},F=e=>{const o=document.getElementById("color-filter");o.innerHTML=e.map(t=>`
    <div class="color-box ${t.name}" data-color="${t.name}" style="background-color: ${t.name}" tabindex="0"></div>
  `).join("")},$=e=>{const o=document.getElementById("gender-filter");o.innerHTML=`
    ${e.map(t=>`
      <label  tabindex="0"><input type="radio" name="gender" value="${t.name}" tabindex="0"> ${t.name}</label>
    `).join("")}
  `},b=e=>{const o=document.getElementById("type-filter");o.innerHTML=e.map(t=>`
    <label><input type="checkbox" name="type" value="${t.name}"> ${t.name}</label>
  `).join("")},B=e=>{F(e.colors),$(e.genders),b(e.types)},I=e=>{if(e){if(e.types.length===1)return`--typeColor:var(--type-${e.types[0]}); --secondary-typeColor:var(--type-${e.types[0]});`;if(e.types.length>1)return`--typeColor:var(--type-${e.types[0]}); --secondary-typeColor:var(--type-${e.types[1]});`}},T=e=>(e||console.error(`No pokemon information was provided for ${e}`),`
    <div class="pokemon" style="${I(e)}" tabindex="0">
      <div class="pokemon__img-container">
          <img class="pokemon__img" data-id="${e.id}" src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${e.id}.png" alt="Image for pokemon ${e.name}">
      </div>
      <div class="pokemon__info">
          <span class="pokemon__info__number">#${e.id.toString().padStart(4,"0")}</span>
          <h3 class="pokemon__info__name">${e.name}</h3>
          <small class="pokemon__info__type">Type: <span>${e.types.join(", ")}</span></small>
      </div>
    </div>
  `),k=({pokemonList:e,node:o})=>{if(!e||e.length===0){o.classList.add("no-results"),o.innerHTML='<p class="no-results__text">No Pokémon found. Try different filters, search terms or reset filters.</p>';return}(!o||!(o instanceof Element))&&console.error("Node was not provided or is invalid."),o.classList.remove("no-results"),o.innerHTML=e.map(t=>T(t)).join("")},g=()=>{const e=document.getElementsByClassName("pokemon-count")[0];e.innerHTML=`
    <span class="pokemon-count__pokemon__number">${n.pokemonList.length}</span> Pokémon displayed
  `},N=async()=>{const e=document.getElementById("pokemon-list");n.selectedFilters={color:[],gender:"",types:[]},n.searchTerm="",n.currentOffset=0,n.pokemonList=[],document.getElementById("search-input").value="",document.querySelectorAll(".color-box").forEach(t=>{t.classList.remove("selected"),t.innerHTML=""}),document.querySelectorAll('input[name="gender"]').forEach(t=>t.checked=!1),document.querySelectorAll('input[name="type"]').forEach(t=>t.checked=!1);const o=await f({pokemonList:n.allPokemon,offset:0,limit:20});k({pokemonList:o,node:e}),g()};function S(e,o){let t;return function(...s){const r=this;clearTimeout(t),t=setTimeout(()=>e.apply(r,s),o)}}const M=async e=>{var s,r,i;if(!e){console.error("There is no filter data provided.");return}const o=[];(s=e.colorsFilterData)==null||s.forEach(l=>o.push(fetch(l.url).then(a=>a.json()))),e.genderFilterData&&o.push(fetch((r=e.genderFilterData)==null?void 0:r.url).then(l=>l.json())),(i=e.typesFilterData)==null||i.forEach(l=>o.push(fetch(l.url).then(a=>a.json()))),(await Promise.all(o)).forEach(l=>{var a,c,y;(a=l.pokemon_species)!=null&&a.length&&(console.log("color"),l.pokemon_species.forEach(p=>{const d=n.allPokemon.find(u=>u.pokemon_species.name===p.name);d&&(n.filteredPokemons=Array.from(new Set([...n.filteredPokemons,d])))})),(c=l.pokemon_species_details)!=null&&c.length&&(console.log("gender"),l.pokemon_species_details.forEach(p=>{const d=n.allPokemon.find(u=>u.pokemon_species.name===p.pokemon_species.name);d&&(n.filteredPokemons=Array.from(new Set([...n.filteredPokemons,d])))})),(y=l.pokemon)!=null&&y.length&&(console.log("types"),l.pokemon.forEach(p=>{const d=n.allPokemon.find(u=>u.pokemon_species.name===p.pokemon.name);d&&(n.filteredPokemons=Array.from(new Set([...n.filteredPokemons,d])))}))}),console.log(n)},C=()=>{const e=n.availableFilters.color.filter(s=>n.selectedFilters.color.includes(s.name)),o=n.availableFilters.gender.find(s=>s.name===n.selectedFilters.gender),t=n.availableFilters.types.filter(s=>n.selectedFilters.types.includes(s.name));return{colorsFilterData:e,genderFilterData:o,typesFilterData:t}},A=async()=>{var o,t;const e=document.getElementById("pokemon-list");e.innerHTML="",n.selectedFilters.gender=(o=document.querySelector('input[name="gender"]:checked'))==null?void 0:o.value,n.selectedFilters.types=(t=Array.from(document.querySelectorAll('input[name="type"]:checked')))==null?void 0:t.map(s=>s.value),n.currentOffset=0,n.pokemonList=[],n.filteredPokemons=[],await M(C()),await f({pokemonList:n.filteredPokemons,offset:0,limit:1e3}),k({pokemonList:n.pokemonList,node:e}),g()},O=async e=>await(await fetch(`${m}/pokemon/${e}`)).json(),h=e=>{e.key==="Escape"&&L()},L=()=>{document.getElementById("modal").style.display="none",document.removeEventListener("keydown",h)},j=e=>{const o=document.getElementById("pokemon-details");o.innerHTML=`
    <h2>${e.name} #${e.id.toString().padStart(4,"0")}</h2>
    <img width="475" height="475" src="${e.sprites.other["official-artwork"].front_default}" alt="${e.name}" class="pokemon-image">
    <div>
    <p>Height: ${e.height/10}m</p>
    <p>Weight: ${e.weight/10}kg</p>
    <p>Types: ${e.types.map(t=>t.type.name).join(", ")}</p>
    <p>Abilities: ${e.abilities.map(t=>t.ability.name).join(", ")}</p>
    </div>
  `},P=async e=>{if(e.classList.contains("pokemon__img")){const o=e.dataset.id,t=await O(o),s=document.getElementById("modal");j(t),s.style.display="block",s.querySelector(".close").addEventListener("click",L),document.addEventListener("keydown",h)}},x=async e=>{const o=e.target;await P(o)},H=e=>{e||console.error("No search was provided");let o=[];return isNaN(e)?o=[...n.allPokemon.filter(t=>t.pokemon_species.name.toLowerCase().includes(e))]:o=[...n.allPokemon.filter(t=>t.entry_number===parseInt(e,10))],o},D=async e=>{e||console.error("No criteria was provided in order to search");const o=document.getElementById("pokemon-list");o.innerHTML="";const t=e==null?void 0:e.target.value.trim().toString().toLowerCase(),s=H(t);n.currentOffset=0,n.pokemonList=[],n.filteredPokemons=[],n.searchTerm=t,n.filteredPokemons=s,await f({pokemonList:n.filteredPokemons,offset:0,limit:1e3}),k({pokemonList:n.pokemonList,node:o}),g()},q=()=>{const e=document.getElementById("filters"),o=document.getElementById("close-filters");e.style.display="flex",o.addEventListener("click",()=>{e.style.display="none"})},R=async()=>{const e=document.getElementById("load-more");if(n.currentOffset>=n.totalPokemon){e.style.display="none";return}await f({pokemonList:n.allPokemon,offset:n.currentOffset,limit:n.limit}),n.currentOffset=n.pokemonList.length,n.currentOffset>=n.totalPokemon?e.style.display="none":e.style.display="block"},U=()=>{document.querySelectorAll(".pokemon").forEach(o=>o.addEventListener("keydown",function(t){if(t.key==="Enter"||t.keyCode===13||t.key===" "||t.keyCode===32){t.preventDefault();const s=t.target.getElementsByClassName("pokemon__img")[0];s&&P(s)}}))},E=()=>{const e=document.getElementById("pokemon-list");k({pokemonList:n.pokemonList,node:e}),g(),U()},K=async()=>{await R(),E()},G=async()=>{await _().then(c=>c.pokemon_entries),await f({pokemonList:n.allPokemon,offset:0,limit:20});const e=await w();B(e);const o=document.getElementById("load-more"),t=document.getElementById("apply-filters"),s=document.getElementById("pokemon-list"),r=document.getElementById("search-input"),i=document.getElementById("color-filter"),l=document.getElementById("reset-filters"),a=document.getElementById("menu-trigger");l.addEventListener("click",N),o.addEventListener("click",K),t.addEventListener("click",A),s.addEventListener("click",x),r.addEventListener("input",S(D,500)),i.addEventListener("click",v),a.addEventListener("click",q),E()};G();
