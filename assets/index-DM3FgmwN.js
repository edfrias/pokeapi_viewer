(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=o(r);fetch(r.href,l)}})();const n={pokemonList:[],filteredPokemons:[],allPokemon:[],currentOffset:0,limit:20,selectedFilters:{color:[],gender:"",types:[]},availableFilters:{color:[],gender:[],types:[]},searchTerm:"",totalPokemon:0},m="https://pokeapi.co/api/v2",_=async()=>{const e=`${m}/pokedex/national`,t=await fetch(e);if(!t.ok)return Promise.reject({error:`Something went wrong while retrieving Pokemons at ${e}`});const o=await t.json();return n.allPokemon=o.pokemon_entries,n.totalPokemon=o.pokemon_entries.length,o},y=async({pokemonList:e,offset:t,limit:o})=>{const s=e.slice(t,t+o);return n.currentOffset=t+o,await Promise.all(s.map(async r=>{const i=await(await fetch(`${m}/pokemon/${r.entry_number}`)).json(),a={name:r.pokemon_species.name,url:`${m}/pokemon/${r.entry_number}`,id:r.entry_number,types:i.types.map(c=>c.type.name)};return n.pokemonList=[...n.pokemonList,a].sort((c,p)=>c.id-p.id),a})).catch(r=>console.error(r))},w=async()=>{const[e,t,o]=await Promise.all([fetch(`${m}/pokemon-color`).then(s=>s.json()),fetch(`${m}/gender`).then(s=>s.json()),fetch(`${m}/type`).then(s=>s.json())]);return n.availableFilters.color=[...e.results],n.availableFilters.gender=[...t.results],n.availableFilters.types=[...o.results],{colors:e.results,genders:t.results,types:o.results}},v=e=>{if(console.log("handleColorClick event",e),e.target.classList.contains("color-box")){const t=`
      <svg style="pointer-events: none" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17.837 17.837" xml:space="preserve"><path style="fill:#fff" d="M16.145 2.571a.7.7 0 0 0-.99 0L6.92 10.804l-4.241-4.27a.698.698 0 0 0-.989 0L.204 8.019a.703.703 0 0 0 0 .99l6.217 6.258a.704.704 0 0 0 .99 0L17.63 5.047a.7.7 0 0 0 0-.994l-1.485-1.482z"/></svg>
    `;e.target.classList.contains("selected")?(e.target.classList.remove("selected"),e.target.innerHTML="",n.selectedFilters.color=n.selectedFilters.color.filter(o=>o!==e.target.dataset.color)):(e.target.classList.add("selected"),e.target.innerHTML=t,n.selectedFilters.color=Array.from(new Set([...n.selectedFilters.color,e.target.dataset.color])))}},F=async e=>await(await fetch(`${m}/pokemon/${e}`)).json(),h=e=>{e.key==="Escape"&&L()},L=()=>{document.getElementById("modal").style.display="none",document.removeEventListener("keydown",h)},$=e=>{const t=document.getElementById("pokemon-details");t.innerHTML=`
    <h2>${e.name} #${e.id.toString().padStart(4,"0")}</h2>
    <img width="475" height="475" src="${e.sprites.other["official-artwork"].front_default}" alt="${e.name}" class="pokemon-image">
    <div>
    <p>Height: ${e.height/10}m</p>
    <p>Weight: ${e.weight/10}kg</p>
    <p>Types: ${e.types.map(o=>o.type.name).join(", ")}</p>
    <p>Abilities: ${e.abilities.map(o=>o.ability.name).join(", ")}</p>
    </div>
  `},P=async e=>{if(e.classList.contains("pokemon__img")){const t=e.dataset.id,o=await F(t),s=document.getElementById("modal");$(o),s.style.display="block",s.querySelector(".close").addEventListener("click",L),document.addEventListener("keydown",h)}},E=()=>{document.querySelectorAll(".pokemon").forEach(t=>t.addEventListener("keydown",function(o){if(o.key==="Enter"||o.keyCode===13||o.key===" "||o.keyCode===32){o.preventDefault();const s=o.target.getElementsByClassName("pokemon__img")[0];s&&P(s)}}))},b=e=>{const t=document.getElementById("color-filter");t.innerHTML=e.map(o=>`
    <div class="color-box ${o.name}" data-color="${o.name}" style="background-color: ${o.name}" tabindex="0"></div>
  `).join("")},B=e=>{const t=document.getElementById("gender-filter");t.innerHTML=`
    ${e.map(o=>`
      <label  tabindex="0"><input type="radio" name="gender" value="${o.name}" tabindex="0"> ${o.name}</label>
    `).join("")}
  `},I=e=>{const t=document.getElementById("type-filter");t.innerHTML=e.map(o=>`
    <label><input type="checkbox" name="type" value="${o.name}"> ${o.name}</label>
  `).join("")},T=e=>{b(e.colors),B(e.genders),I(e.types)},N=e=>{if(e){if(e.types.length===1)return`--typeColor:var(--type-${e.types[0]}); --secondary-typeColor:var(--type-${e.types[0]});`;if(e.types.length>1)return`--typeColor:var(--type-${e.types[0]}); --secondary-typeColor:var(--type-${e.types[1]});`}},S=e=>(e||console.error(`No pokemon information was provided for ${e}`),`
    <div class="pokemon" style="${N(e)}" tabindex="0">
      <div class="pokemon__img-container">
          <img class="pokemon__img" data-id="${e.id}" src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${e.id}.png" alt="Image for pokemon ${e.name}">
      </div>
      <div class="pokemon__info">
          <span class="pokemon__info__number">#${e.id.toString().padStart(4,"0")}</span>
          <h3 class="pokemon__info__name">${e.name}</h3>
          <small class="pokemon__info__type">Type: <span>${e.types.join(", ")}</span></small>
      </div>
    </div>
  `),k=({pokemonList:e,node:t})=>{if(!e||e.length===0){t.classList.add("no-results"),t.innerHTML='<p class="no-results__text">No Pokémon found. Try different filters, search terms or reset filters.</p>';return}(!t||!(t instanceof Element))&&console.error("Node was not provided or is invalid."),t.classList.remove("no-results"),t.innerHTML=e.map(o=>S(o)).join("")},g=()=>{const e=document.getElementsByClassName("pokemon-count")[0];e.innerHTML=`
    <span class="pokemon-count__pokemon__number">${n.pokemonList.length}</span> Pokémon displayed
  `},C=async()=>{const e=document.getElementById("pokemon-list");n.selectedFilters={color:[],gender:"",types:[]},n.searchTerm="",n.currentOffset=0,n.pokemonList=[],document.getElementById("search-input").value="",document.querySelectorAll(".color-box").forEach(o=>{o.classList.remove("selected"),o.innerHTML=""}),document.querySelectorAll('input[name="gender"]').forEach(o=>o.checked=!1),document.querySelectorAll('input[name="type"]').forEach(o=>o.checked=!1);const t=await y({pokemonList:n.allPokemon,offset:0,limit:20});k({pokemonList:t,node:e}),g()};function M(e,t){let o;return function(...s){const r=this;clearTimeout(o),o=setTimeout(()=>e.apply(r,s),t)}}const O=async e=>{var s,r,l;if(!e){console.error("There is no filter data provided.");return}const t=[];(s=e.colorsFilterData)==null||s.forEach(i=>t.push(fetch(i.url).then(a=>a.json()))),e.genderFilterData&&t.push(fetch((r=e.genderFilterData)==null?void 0:r.url).then(i=>i.json())),(l=e.typesFilterData)==null||l.forEach(i=>t.push(fetch(i.url).then(a=>a.json()))),(await Promise.all(t)).forEach(i=>{var a,c,p;(a=i.pokemon_species)!=null&&a.length&&(console.log("color"),i.pokemon_species.forEach(f=>{const d=n.allPokemon.find(u=>u.pokemon_species.name===f.name);d&&(n.filteredPokemons=Array.from(new Set([...n.filteredPokemons,d])))})),(c=i.pokemon_species_details)!=null&&c.length&&(console.log("gender"),i.pokemon_species_details.forEach(f=>{const d=n.allPokemon.find(u=>u.pokemon_species.name===f.pokemon_species.name);d&&(n.filteredPokemons=Array.from(new Set([...n.filteredPokemons,d])))})),(p=i.pokemon)!=null&&p.length&&(console.log("types"),i.pokemon.forEach(f=>{const d=n.allPokemon.find(u=>u.pokemon_species.name===f.pokemon.name);d&&(n.filteredPokemons=Array.from(new Set([...n.filteredPokemons,d])))}))}),console.log(n)},j=()=>{const e=n.availableFilters.color.filter(s=>n.selectedFilters.color.includes(s.name)),t=n.availableFilters.gender.find(s=>s.name===n.selectedFilters.gender),o=n.availableFilters.types.filter(s=>n.selectedFilters.types.includes(s.name));return{colorsFilterData:e,genderFilterData:t,typesFilterData:o}},A=async()=>{var t,o;const e=document.getElementById("pokemon-list");e.innerHTML="",n.selectedFilters.gender=(t=document.querySelector('input[name="gender"]:checked'))==null?void 0:t.value,n.selectedFilters.types=(o=Array.from(document.querySelectorAll('input[name="type"]:checked')))==null?void 0:o.map(s=>s.value),n.currentOffset=0,n.pokemonList=[],n.filteredPokemons=[],await O(j()),await y({pokemonList:n.filteredPokemons,offset:0,limit:1e3}),k({pokemonList:n.pokemonList,node:e}),g()},x=async e=>{const t=e.target;await P(t)},H=async()=>{const e=document.getElementById("pokemon-list"),t=document.getElementById("load-more");if(n.currentOffset>=n.totalPokemon){t.style.display="none";return}await y({pokemonList:n.allPokemon,offset:n.currentOffset,limit:n.limit}),n.currentOffset=n.pokemonList.length,n.currentOffset>=n.totalPokemon?t.style.display="none":t.style.display="block",k({pokemonList:n.pokemonList,node:e}),g(),E()},D=e=>{e||console.error("No search was provided");let t=[];return isNaN(e)?t=[...n.allPokemon.filter(o=>o.pokemon_species.name.toLowerCase().includes(e))]:t=[...n.allPokemon.filter(o=>o.entry_number===parseInt(e,10))],t},q=async e=>{e||console.error("No criteria was provided in order to search");const t=document.getElementById("pokemon-list");t.innerHTML="";const o=e==null?void 0:e.target.value.trim().toString().toLowerCase(),s=D(o);n.currentOffset=0,n.pokemonList=[],n.filteredPokemons=[],n.searchTerm=o,n.filteredPokemons=s,await y({pokemonList:n.filteredPokemons,offset:0,limit:1e3}),k({pokemonList:n.pokemonList,node:t}),g()},R=()=>{const e=document.getElementById("filters"),t=document.getElementById("close-filters");e.style.display="flex",t.addEventListener("click",()=>{e.style.display="none"})},K=async()=>{await _().then(p=>p.pokemon_entries);const e=await y({pokemonList:n.allPokemon,offset:0,limit:20}),t=await w();T(t);const o=document.getElementById("load-more"),s=document.getElementById("apply-filters"),r=document.getElementById("pokemon-list"),l=document.getElementById("search-input"),i=document.getElementById("color-filter"),a=document.getElementById("reset-filters"),c=document.getElementById("menu-trigger");a.addEventListener("click",C),o.addEventListener("click",H),s.addEventListener("click",A),r.addEventListener("click",x),l.addEventListener("input",M(q,500)),i.addEventListener("click",v),c.addEventListener("click",R),k({pokemonList:e,node:r}),g(),E()};K();
